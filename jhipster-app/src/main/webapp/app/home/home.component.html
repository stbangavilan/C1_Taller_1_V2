<div class="container mt-4">
  <h2 class="mb-3">
    
    Proceso Principal (Inventario)
  </h2>

  <form [formGroup]="form" (ngSubmit)="procesarMovimiento()">
    <div class="row">
      <div class="col-md-3 mb-3">
        <label class="form-label">Tipo</label>
        <select class="form-select" formControlName="tipo">
          <option value="ENTRADA">ENTRADA</option>
          <option value="SALIDA">SALIDA</option>
          <option value="AJUSTE">AJUSTE</option>
          <option value="TRANSFERENCIA">TRANSFERENCIA</option>
        </select>
        <div class="text-danger mt-1" *ngIf="form.get('tipo')?.touched && form.get('tipo')?.invalid">
          Tipo es obligatorio.
        </div>
      </div>

      <div class="col-md-3 mb-3">
        <label class="form-label">Producto ID</label>
        <input type="number" class="form-control" formControlName="productoId" />
        <div class="text-danger mt-1" *ngIf="form.get('productoId')?.touched && form.get('productoId')?.invalid">
          ProductoId es obligatorio.
        </div>
      </div>

      <div class="col-md-3 mb-3">
        <label class="form-label">Cantidad</label>
        <input type="number" class="form-control" formControlName="cantidad" step="0.01" />
        <div class="text-danger mt-1" *ngIf="form.get('cantidad')?.touched && form.get('cantidad')?.invalid">
          Cantidad es obligatoria y debe ser &gt; 0.
        </div>
      </div>

      <div class="col-md-3 mb-3">
        <label class="form-label">Referencia</label>
        <input type="text" class="form-control" formControlName="referencia" />
      </div>
    </div>

    <div class="row">
      <div class="col-md-3 mb-3">
        <label class="form-label">Local Origen ID</label>
        <input type="number" class="form-control" formControlName="localOrigenId" />
        <small class="text-muted">Usado para SALIDA / AJUSTE / TRANSFERENCIA</small>
      </div>

      <div class="col-md-3 mb-3">
        <label class="form-label">Local Destino ID</label>
        <input type="number" class="form-control" formControlName="localDestinoId" />
        <small class="text-muted">Usado para ENTRADA / TRANSFERENCIA</small>
      </div>
    </div>

    <button class="btn btn-primary" type="submit" [disabled]="loading">
      {{ loading ? 'Procesando...' : 'Procesar' }}
    </button>
  </form>

  <div *ngIf="mensajeOk" class="alert alert-success mt-3">
    {{ mensajeOk }}
  </div>

  <div *ngIf="mensajeError" class="alert alert-danger mt-3">
    {{ mensajeError }}
  </div>

  <div *ngIf="resultado" class="mt-3">
    <h5>Respuesta</h5>
    <pre class="bg-light p-3 border rounded">{{ resultado | json }}</pre>
  </div>
</div>
